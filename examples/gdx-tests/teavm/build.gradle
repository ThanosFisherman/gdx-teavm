plugins {
    id "org.gretty" version '3.1.0'
}

gretty {
    contextPath = '/'
    extraResourceBase 'build/dist/webapp'
}

dependencies {
    implementation "com.badlogicgames.gdx:gdx:$project.gdxVersion"
    implementation project(":examples:gdx-tests:core")

    implementation project(":backends:backend-teavm")
    implementation project(":extensions:gdx-freetype-teavm")
    implementation project(":extensions:gdx-bullet:gdx-bullet-teavm")
    implementation 'com.badlogicgames.gdx:gdx-box2d-gwt:1.11.0'

    implementation "com.github.xpenatan.gdx-imgui:core-teavm:$project.gdxImGuiVersion"
}

project.ext.gdxTestMainClassName = "com.github.xpenatan.gdx.examples.teavm.BuildGdxTest"

tasks.register('buildGdxTest', JavaExec) {
    dependsOn classes
    setGroup("teavm")
    setDescription("Build gdx-tests example")
    mainClass.set(project.gdxTestMainClassName)
    setClasspath(sourceSets.main.runtimeClasspath)
}

tasks.register('runGdxTest') {
    dependsOn[':examples:gdx-tests:teavm:clean', ':examples:gdx-tests:teavm:buildGdxTest', ':examples:gdx-tests:teavm:jettyRun']
    setGroup("examples-teavm")
    setDescription("Run gdx-tests")
}

runGdxTest.shouldRunAfter ":examples:gdx-tests:teavm:clean"